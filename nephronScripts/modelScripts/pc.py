from classDefs import namespace

## The indices of various values as used in the fluxes

pcITCA = namespace(
    ipdh = 0,
    icits = 1,
    iacon = 2,
    iisod = 3,
    iakgd = 4,
    iscoas = 5,
    isdh = 6,
    ifum = 7,
    imdh = 8,
    indk = 9,
    igot = 10
)

pcFl = namespace(
    J_C1 = 0,
    J_C3 = 1,
    J_C4 = 2,
    J_F1 = 3,
    J_ANT = 4,
    J_Pi1 = 5,
    J_Hle = 6,
    J_KH = 7,
    J_pdh = 8,
    J_cits = 9,
    J_acon = 10,
    J_isod = 11,
    J_akgd = 12,
    J_scoas = 13,
    J_sdh = 14,
    J_fum = 15,
    J_mdh = 16,
    J_ndk = 17,
    J_got = 18,
    J_Pi2 = 19,
    J_ATP = 20,
    J_ADP = 21,
    J_AMP = 22,
    J_PYR_H = 23,
    J_GLU_H = 24,
    J_CIT_MAL = 25,
    J_SUC_MAL = 26,
    J_AKG_MAL = 27,
    J_MAL_PI = 30,
    J_ASP_GLU = 31,
    J_PYRt = 32,
    J_CITt = 33,
    J_ICITt = 34,
    J_MALt = 35,
    J_AKGt = 36,
    J_SUCt = 37,
    J_FUMt = 38,
    J_GLUt = 39,
    J_ASPt = 40,
    J_HK = 41,
    J_Kle = 42,
    J_AKi = 43,
    J_CKe = 44,
    J_AKe = 45,
    J_gdh = 46
)

pcIR = namespace(
    iH = 0,
    iATP = 1,
    iADP = 2,
    iAMP = 3,
    iGTP = 4,
    iGDP = 5,
    iPi = 6,
    iNADH = 7,
    iNAD = 8,
    iQH2 = 9,
    iCOQ = 10,
    iOAA = 11,
    iACCOA = 12,
    iCIT = 13,
    iICIT = 14,
    iAKG = 15,
    iSCOA = 16,
    iCOASH = 17,
    iSUC = 18,
    iFUM = 19,
    iMAL = 20,
    iGLU = 21,
    iASP = 22,
    iK = 23,
    iMg = 24,
    iCox = 25,
    iCred = 26,
    iO2 = 27,
    iH2O = 28,
    iFADH2 = 29,
    iFAD = 30,
    iCO2tot = 31,
    iPCr = 32,
    iCr = 33,
    iPYR = 34,
    iGLC = 35,
    iG6P = 36)

## The physical constants

W_m = 0.659

pcPC = namespace(
    ## Thermodynamic constants
    RT = 8.314*(37+273.15)/1e3, # kJ  mol^{-1}
    F = 0.096484, # kJ mol^{-1} mV^{-1},
    W_m = W_m,  # 0.664 * 1.09 # mitochondrial water space(ml water per ml mito) [VB2002]
    W_x = 0.9 * W_m,  # Matrix water space
    W_i = 0.1 * W_m,  # IM water space
    # Pooled concentrations of compounds with two associated states
    Ctot = 1.956e-3, # 2.70e-3 # M total cytoC
    Qtot = 2.148e-3, # 1.35e-3 # M total Q + QH2
    NADtot = 0.824e-3, # 2.97e-3  M #total NAD + NADH
    NADtotmTAL = 0.824e-4, # Preliminary value as of 2021-01-11
    FADtot = 0.1e-3, # M total FADred + FADox (from Feng Yang)
    # Ox Phos Model Parameters
    n_A = 3.0,  # unitless
    k_O2 = 1.32e-4,
    k_O2mTAL = 6e-05,
    k_mADP = 3.5e-6
)

del W_m

## Previously global variables in the MatLab model, indices of state variables

pcIS = namespace(
    #  (i) Matrix species and dPsi
    iH_x = 0,
    idPsi = 1,
    iATP_x = 2,
    iADP_x = 3,
    iAMP_x = 4,
    iGTP_x = 5,
    iGDP_x = 6,
    iPi_x = 7,
    iNADH_x = 8,
    iQH2_x = 9,
    iOAA_x = 10,
    iACCOA_x = 11,
    iCIT_x = 12,
    iICIT_x = 13,
    iAKG_x = 14,
    iSCOA_x = 15,
    iCOASH_x = 16,
    iSUC_x = 17,
    iFUM_x = 18,
    iMAL_x = 19,
    iGLU_x = 20,
    iASP_x = 21,
    iK_x = 22,
    iMg_x = 23,
    iO2_x = 24,
    iCO2tot_x = 25,
    # (ii) IM space species
    iCred_i = 26,
    iATP_i = 27,
    iADP_i = 28,
    iAMP_i = 29,
    iPi_i = 30,
    iH_i = 31,
    iMg_i = 32,
    iK_i = 33,
    #  (iii) Cytoplasmic species
    iATP_c = 34,
    iADP_c = 35,
    iPi_c = 36,
    iH_c = 37,
    iMg_c = 38,
    iK_c = 39,
    # added variable
    iPYR_x = 40,
    iPYR_i = 41,
    iPYR_c = 42,
    iCIT_i = 43,
    iCIT_c = 44,
    iAKG_i = 45,
    iAKG_c = 46,
    iSUC_i = 47,
    iSUC_c = 48,
    iMAL_i = 49,
    iMAL_c = 50,
    iASP_i = 51,
    iASP_c = 52,
    iGLU_i = 53,
    iGLU_c = 54,
    iFUM_i = 55,
    iFUM_c = 56,
    iICIT_i = 57,
    iICIT_c = 58,
    iGLC_c = 59,
    iG6P_c = 60,
    iPCr_c = 61,
    iAMP_c = 62
)

pc = namespace(
    N_reactant = pcIR.len(),
    N_flux = 47,
    N_states = pcIS.len()
)

## Default initial conditions

ics = [
    7.8683e-008,
    1.8719e+002,
    1.5000e-003, # 8.4861e-003 % [ATP]x
    0.8750e-003, # 1.5139e-003 % [ADP]x
    0.3750e-003, # 1.0000e-006 % [AMP]x
    4.2630e-003,
    7.3703e-004,
    1.7773e-003,
    2.6060e-003,
    3.7948e-004,
    1.7809e-011,
    2.9865e-003,
    6.2053e-004,
    1.2357e-005,
    2.1134e-005,
    1.3988e-006,
    2.1962e-005,
    8.3893e-005,
    5.9623e-005,
    1.6456e-004,
    1.0247e-004,
    6.7473e-011,
    1.1000e-001, # 1.0229e-001 % [K]x - Assume close to [K+]c
    2.1298e-003, # [Mg2+]x
    6.69e-005, # [O2]x (O2 in M; equivalent to 50 mmHg)
    2.1400e-002,
    4.1548e-004,
    1.5000e-003, # 1.0696e-002 % [ATP]i
    0.8750e-003, # 2.3667e-006 % [ADP]i
    0.3750e-003, # 2.6264e-010 % [AMP]i
    1.1398e-003,
    6.3096e-008, # %3.9811e-008; %1.0000e-007 %1.5849e-007; [H+]i
    1.0030e-003,
    1.3000e-001,
    1.5000e-003, #8.1976e-003 % [ATP]c
    0.8750e-003, #2.3667e-006 % [ADP]c
    9.8750e-003, #9.8750e-003 %1.1398e-003 % [Pi]c
    6.3096e-008, #6.3096e-008 %3.9811e-008; %1.0000e-007 %1.5849e-007; % [H+]c pHc = 7.4, 7.2, 7.0, 6.8
    0.4000e-003, #0.4000e-003 %1.0030e-003 % [Mg2+]c
    1.1000e-001, #1.3000e-001 % [K+]c
    7.5738e-005,
    5.9906e-005,
    1.5375e-004, #6.0000e-005 % [PYR]c
    1.0000e-004,
    0.7250e-003, #1.0000e-004 % [CIT]c
    1.4621e-005,
    7.1250e-005, #1.5000e-005 % [AKG]c
    6.2500e-005,
    1.2500e-005, #6.2500e-005 % [SUC]c
    1.0038e-004,
    0.4625e-003, #1.0000e-004 % [MAL]c
    3.1592e-006,
    1.3000e-003, #3.1593e-006 % [ASP]c
    8.0646e-005,
    6.4625e-003, #8.0646e-005 % [GLUtamate]c
    1.5000e-005,
    6.2500e-005, #1.5000e-005 % [FUM]c
    1.5000e-005,
    7.2500e-005, #1.5000e-005 % [iCIT]c
    7.2500e-003, #1.0000e-032 % [GLC]c
    9.1250e-005, #1.0000e-032 % [6GP]c
    5.0000e-005, #4.1774e-002 % [Phosphate Creatine]c
    0.3750e-003  #2.6264e-010 %[AMP]c
]

vitroics = [
    5.7919e-008,
    -1.4087e+001,
    1.0250e-011,
    1.0000e-002,
    1.0000e-006,
    2.7157e-010,
    5.0000e-003,
    2.9918e-004,
    8.4842e-021,
    0,
    8.9236e-004,
    2.5507e-012,
    6.8151e-005,
    9.3558e-007,
    4.7979e-011,
    6.9627e-010,
    3.0107e-003,
    2.1681e-007,
    7.8476e-009,
    3.2191e-008,
    9.9311e-012,
    1.0217e-004,
    8.6878e-002,
    4.6388e-003,
    6.5000e-005,
    2.1400e-002,
    9.6996e-008,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009,
    1.1574e-004,
    1.0000e-007,
    5.0000e-003,
    1.5000e-001,
    1.0000e-009,
    1.0000e-009,
    1.1574e-004,
    1.0000e-007,
    5.0000e-003,
    1.5000e-001,
    1.2076e-011,
    9.1804e-010,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009,
    9.9995e-010,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009,
    1.0001e-009,
    1.0000e-009,
    4.4404e-009,
    4.4404e-009,
    5.7539e-012,
    5.7540e-012,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009,
    1.0000e-009
]

params = [
    0.2051,
    9.8253,
    0.0277,
    0.4920,
    0.0876,
    0.4485,
    0.0858,
    0.0071,
    0.0771,
    0.0255,
    4.5514,
    2.9968e+08,
    2.7251e+08,
    80.4321,
    0.2821,
    157.6252,
    16.0624,
    5.8656e-05,
    9.2363e-08,
    0.6000,
    96.9956,
    0.2143,
    6.0105e-07,
    2.3009e-08,
    0.1071,
    4.3200e-08,
    0.0026,
    1.6531,
    0.3107,
    4.8860e+08,
    3.2365e+04,
    0.7908,
    1.0761e-04,
    8.1204e+03,
    0.00675, #0.00506, # before 2020-11-19
    3.3356e+07,
    0.0016,
    412360.0, # 3.172e5 # before 2020-11-24
    521.1, #807.71, # before 2021-11-24
    3.2489e-05,
    0.0035,
    1
]

paramsmTAL = [
    0.2051,
    9.8253,
    0.0277,
    0.4920,
    0.0876,
    0.4485,
    0.0858,
    0.0071,
    0.0771,
    0.0255,
    4.5514,
    2.9968e+08,
    2.7251e+08,
    80.4321,
    0.2821,
    157.6252,
    16.0624,
    5.8656e-05,
    9.2363e-08,
    0.6000,
    96.9956,
    0.2143,
    6.0105e-07,
    2.3009e-08,
    0.1071,
    4.3200e-08,
    0.0026,
    1.6531,
    0.3107,
    4.8860e+08,
    3.2365e+04,
    0.7908,
    1.0761e-04,
    8.1204e+03,
    0.00675, #0.00506,
    3.3356e+07,
    0.0016,
    3.172e5,
    347.4, #347.4, #521.1, #
    3.2489e-05,
    0.0035,
    1
]

## Final conditions is results.tail(1) from mainDynamical.py, minus the time
finalConditions = [4.94456820e-08, 1.59763746e+02, 9.80310651e-04,
  1.39468935e-03, 3.75000000e-04, 2.13605999e-03, 2.86397001e-03,
  5.96404775e-03, 6.26326288e-05, 2.81510568e-04, 1.42221113e-10,
  3.00855373e-03, 8.60862501e-04, 1.68141513e-05, 8.33678891e-04,
  6.53701589e-08, 1.24169868e-06, 1.91531720e-05, 2.17728435e-05,
  1.05001221e-05, 7.81325727e-03, 9.33456035e-10, 1.23762721e-01,
  2.04478558e-03, 6.69000000e-05, 2.14000000e-02, 5.87830773e-04,
  2.33313719e-03, 3.75528768e-04, 3.97460558e-05, 3.63317537e-03,
  6.30960000e-08, 1.00300000e-03, 1.30000000e-01, 2.32607099e-03,
  3.82594969e-04, 3.63501215e-03, 6.30960000e-08, 4.00000000e-04,
  1.10000000e-01, 1.76746364e-04, 1.53123144e-04, 1.53750000e-04,
  5.29858412e-04, 5.29858419e-04, 4.87545358e-04, 4.87545354e-04,
  1.14089807e-05, 1.14089807e-05, 6.14061438e-06, 6.14061437e-06,
  2.79715128e-07, 2.79715130e-07, 5.53787414e-03, 5.53787414e-03,
  1.50000000e-05, 6.25000000e-05, 7.08405956e-05, 7.08405956e-05,
  7.25000000e-03, 9.12500000e-05, 4.60957541e-03, 4.13812337e-05]

optimFinalConditions = [
    -7.94652591e-12,
    2.48350600e-04,
    -1.36914517e-09,
    1.36914517e-09,
    0.00000000e+00,
    2.08318483e-17,
    -2.08318483e-17,
    1.36914264e-09,
    -2.91625879e-08,
    -4.95940075e-04,
    -2.51549549e-07,
    -2.50524545e-07,
    -2.20199541e-02,
    2.20202046e-02,
    9.41428638e-10,
    -2.08318483e-17,
    2.50524545e-07,
    -1.19051475e-11,
    -1.13155176e-02,
    1.13155177e-02,
    -9.90983538e-09,
    -2.89337105e-08,
    9.85716731e-04,
    1.11400366e-12,
    0.00000000e+00,
    0.00000000e+00,
    8.92744649e-03,
    -1.51745068e-08,
    3.03490137e-08,
    -1.51745068e-08,
    2.26056275e-14,
    0.00000000e+00,
    0.00000000e+00,
    0.00000000e+00,
    -1.63117692e-03,
    1.63117822e-03,
    1.63116883e-03,
    0.00000000e+00,
    0.00000000e+00,
    0.00000000e+00,
    -5.23607501e-20,
    4.71246751e-19,
    0.00000000e+00,
    5.00128492e-11,
    -0.00000000e+00,
    7.51004978e-10,
    -0.00000000e+00,
    1.36508086e-13,
    -0.00000000e+00,
    -8.01176941e-10,
    -0.00000000e+00,
    2.00414252e-04,
    -5.94765997e-06,
    -2.37164238e-05,
    7.07152778e-07,
    0.00000000e+00,
    -0.00000000e+00,
    0.00000000e+00,
    -0.00000000e+00,
    0.00000000e+00,
    0.00000000e+00,
    6.78727638e-09,
    -1.29870130e-09
]